<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Browser Dangerous Byte Fuzz</title>
</head>
<body>
  <h2>Browser Dangerous Byte Fuzzing</h2>
  <p>If anything appears below in red, it means the browser may have rendered a dangerous character!</p>

  <script>
    // JavaScript to test how browsers render all byte values from %00 to %FF
    // and whether any of them get interpreted as dangerous characters: / ? \ # .

    (function () {
        const dangerousTargets = ['/', '?', '\\', '#', '.'];
        const results = [];

        for (let i = 0x00; i <= 0xFF; i++) {
            const hex = i.toString(16).toUpperCase().padStart(2, '0');
            const encoded = `%${hex}`;

            let decoded;
            try {
                decoded = decodeURIComponent(encoded);
            } catch {
                decoded = '[decodeURIComponent failed]';
            }

            // Determine if it matches any dangerous character
            const isDangerous = dangerousTargets.includes(decoded);

            results.push({
                Encoded: encoded,
                Decoded: decoded,
                DangerousMatch: isDangerous ? 'YES' : 'NO'
            });

            // Only show dangerous matches in DOM
            if (isDangerous) {
                const div = document.createElement("div");
                div.textContent = `Encoded: ${encoded} â†’ Decoded: ${decoded}`;
                div.style.color = "red";
                div.style.fontWeight = "bold";
                document.body.appendChild(div);
            }
        }

        console.table(results);
    })();
  </script>

<script>
  def test_redirect_js(request):
    response = HttpResponse("", status=302)
    response['Location'] = 'javascript:alert(`last webpage you opened was ${document.location.href} with cookie ${document.cookie}`)'
    response['status'] = '302'
    return response
      </script>
</body>
</html>
